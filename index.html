<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Gaji Berkala</title>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#f6f8fa;
}
header{
  background:#24292f;
  color:white;
  padding:20px 40px;
  font-size:26px;
  font-weight:600;
}
.container{ padding:30px 40px; }
table{
  width:100%;
  border-collapse:collapse;
  background:white;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
}
th{
  background:#0969da;
  color:white;
  padding:12px;
  text-align:left;
  position:sticky;
  top:0;
}
td{
  padding:10px;
  border-bottom:1px solid #eaecef;
}
tr:hover{ background:#f0f6fc; }
input,select{
  width:100%;
  padding:8px;
  border:1px solid #d0d7de;
  border-radius:6px;
}
.btn{
  background:#2da44e;
  color:white;
  padding:6px 12px;
  border-radius:6px;
  text-decoration:none;
}
.badge{
  background:#ddf4ff;
  color:#0969da;
  padding:4px 8px;
  border-radius:20px;
  font-size:13px;
}
</style>
</head>

<body>

<header>Dashboard Gaji Berkala</header>

<div class="container">
<table>
<thead>
<tr>
  <th>Nama</th>
  <th>NIP</th>
  <th>Gol</th>
  <th>Jabatan</th>
  <th>Folder</th>
  <th>Waktu</th>
  <th>Catatan Verifikator</th>
  <th>No Surat</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbxdo698t8A0zeD9N1dDAH02dE9IDordhU5UDR51eY44iuRALwk640wsreIL1nQOIq_o/exec";

let DROPDOWN = [];

Promise.all([
  fetch(GAS_URL).then(r=>r.json()),
  fetch(GAS_URL+"?type=dropdown").then(r=>r.json())
]).then(([data, dropdown])=>{
  DROPDOWN = dropdown;
  render(data);
});

function render(data){
  const tb = document.getElementById("tbody");
  tb.innerHTML="";
  data.forEach(r=>{
    tb.innerHTML += `
    <tr>
      <td><b>${r.nama}</b></td>
      <td>${r.nip}</td>
      <td><span class="badge">${r.gol}</span></td>
      <td>${r.jabatan}</td>
      <td>${r.folder ? `<a class="btn" target="_blank" href="${r.folder}">Buka</a>` : "-"}</td>
      <td>${r.waktu || "-"}</td>
      <td>
        <select onchange="update(${r.row},'catatan',this.value)">
          ${DROPDOWN.map(d=>`<option ${d===r.catatan?'selected':''}>${d}</option>`).join("")}
        </select>
      </td>
      <td>
        <input value="${r.nosurat||""}" 
          onchange="update(${r.row},'nosurat',this.value)">
      </td>
    </tr>`;
  });
}

function update(row,field,value){
  fetch(GAS_URL,{
    method:"POST",
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({row,field,value})
  });
}
</script>

</body>
</html>
